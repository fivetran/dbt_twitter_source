{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.3", "generated_at": "2023-12-12T20:10:12.623141Z", "invocation_id": "90feb37d-3235-42a7-a05e-c4aa680b4f85", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.356978Z", "completed_at": "2023-12-12T20:10:11.366556Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.368673Z", "completed_at": "2023-12-12T20:10:11.368689Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.036000728607177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"twitter_ads_source_integration_tests\".\"twitter_campaign_history_data\"", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.336980Z", "completed_at": "2023-12-12T20:10:11.366862Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.369803Z", "completed_at": "2023-12-12T20:10:11.369810Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03762984275817871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"twitter_ads_source_integration_tests\".\"twitter_account_history_data\"", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__account_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.360013Z", "completed_at": "2023-12-12T20:10:11.367601Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.370814Z", "completed_at": "2023-12-12T20:10:11.370817Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.037744760513305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__campaign_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"twitter_ads_source_integration_tests\".\"twitter_campaign_report_data\"", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.363155Z", "completed_at": "2023-12-12T20:10:11.367922Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.371101Z", "completed_at": "2023-12-12T20:10:11.371105Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03776836395263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__line_item_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"twitter_ads_source_integration_tests\".\"twitter_line_item_history_data\"", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.377077Z", "completed_at": "2023-12-12T20:10:11.394807Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.395817Z", "completed_at": "2023-12-12T20:10:11.395825Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.022580862045288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__line_item_keywords_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"twitter_ads_source_integration_tests\".\"twitter_line_item_keywords_report_data\"", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_keywords_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.386243Z", "completed_at": "2023-12-12T20:10:11.397044Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.399693Z", "completed_at": "2023-12-12T20:10:11.399698Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.025271177291870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__promoted_tweet_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"twitter_ads_source_integration_tests\".\"twitter_promoted_tweet_history_data\"", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.389128Z", "completed_at": "2023-12-12T20:10:11.397402Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.399989Z", "completed_at": "2023-12-12T20:10:11.399993Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.025332927703857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__promoted_tweet_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"twitter_ads_source_integration_tests\".\"twitter_promoted_tweet_report_data\"", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.382270Z", "completed_at": "2023-12-12T20:10:11.398004Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.400545Z", "completed_at": "2023-12-12T20:10:11.400548Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03045821189880371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__line_item_report_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"twitter_ads_source_integration_tests\".\"twitter_line_item_report_data\"", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_report_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.401978Z", "completed_at": "2023-12-12T20:10:11.408267Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.415779Z", "completed_at": "2023-12-12T20:10:11.415785Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017850875854492188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__tweet_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"twitter_ads_source_integration_tests\".\"twitter_tweet_data\"", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__tweet_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.412308Z", "completed_at": "2023-12-12T20:10:11.414018Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.417559Z", "completed_at": "2023-12-12T20:10:11.417564Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011602163314819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.twitter_source_integration_tests.twitter_account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.414374Z", "completed_at": "2023-12-12T20:10:11.415424Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.417881Z", "completed_at": "2023-12-12T20:10:11.417885Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011725187301635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.twitter_source_integration_tests.twitter_account_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.409610Z", "completed_at": "2023-12-12T20:10:11.417250Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.420414Z", "completed_at": "2023-12-12T20:10:11.420422Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01506805419921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__tweet_url_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"twitter_ads_source_integration_tests\".\"twitter_tweet_url_data\"", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__tweet_url_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.423247Z", "completed_at": "2023-12-12T20:10:11.424453Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.429398Z", "completed_at": "2023-12-12T20:10:11.429404Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01085805892944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.twitter_source_integration_tests.twitter_campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.426422Z", "completed_at": "2023-12-12T20:10:11.427573Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.432647Z", "completed_at": "2023-12-12T20:10:11.432652Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011493206024169922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.twitter_source_integration_tests.twitter_campaign_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.427979Z", "completed_at": "2023-12-12T20:10:11.429025Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.432921Z", "completed_at": "2023-12-12T20:10:11.432924Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011610031127929688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.twitter_source_integration_tests.twitter_line_item_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.431149Z", "completed_at": "2023-12-12T20:10:11.432255Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.435204Z", "completed_at": "2023-12-12T20:10:11.435208Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010585784912109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.twitter_source_integration_tests.twitter_line_item_keywords_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.437621Z", "completed_at": "2023-12-12T20:10:11.439477Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.443870Z", "completed_at": "2023-12-12T20:10:11.443877Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010381221771240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.twitter_source_integration_tests.twitter_line_item_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.441095Z", "completed_at": "2023-12-12T20:10:11.442023Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.446796Z", "completed_at": "2023-12-12T20:10:11.446800Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.011129140853881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.twitter_source_integration_tests.twitter_promoted_tweet_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.442385Z", "completed_at": "2023-12-12T20:10:11.443456Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.447054Z", "completed_at": "2023-12-12T20:10:11.447057Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011327028274536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.twitter_source_integration_tests.twitter_promoted_tweet_report_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.445495Z", "completed_at": "2023-12-12T20:10:11.446510Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.449311Z", "completed_at": "2023-12-12T20:10:11.449314Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009740829467773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.twitter_source_integration_tests.twitter_tweet_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.451649Z", "completed_at": "2023-12-12T20:10:11.452662Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.465826Z", "completed_at": "2023-12-12T20:10:11.465834Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018077850341796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.twitter_source_integration_tests.twitter_tweet_url_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.454551Z", "completed_at": "2023-12-12T20:10:11.759009Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.759532Z", "completed_at": "2023-12-12T20:10:11.759536Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3529627323150635, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select *\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_history_tmp\"\n\n),\n\nfields as (\n\n    select\n    \n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    currency\n    \n as \n    \n    currency\n    \n, \n    \n    \n    daily_budget_amount_local_micro\n    \n as \n    \n    daily_budget_amount_local_micro\n    \n, \n    \n    \n    deleted\n    \n as \n    \n    deleted\n    \n, \n    \n    \n    duration_in_days\n    \n as \n    \n    duration_in_days\n    \n, \n    \n    \n    end_time\n    \n as \n    \n    end_time\n    \n, \n    \n    \n    entity_status\n    \n as \n    \n    entity_status\n    \n, \n    \n    \n    frequency_cap\n    \n as \n    \n    frequency_cap\n    \n, \n    \n    \n    funding_instrument_id\n    \n as \n    \n    funding_instrument_id\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    servable\n    \n as \n    \n    servable\n    \n, \n    \n    \n    standard_delivery\n    \n as \n    \n    standard_delivery\n    \n, \n    \n    \n    start_time\n    \n as \n    \n    start_time\n    \n, \n    \n    \n    total_budget_amount_local_micro\n    \n as \n    \n    total_budget_amount_local_micro\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from source\n\n), \n\nfinal as (\n\n    select\n        source_relation,\n        account_id,\n        created_at as created_timestamp,\n        currency,\n        daily_budget_amount_local_micro,\n        deleted as is_deleted,\n        duration_in_days,\n        end_time as end_timestamp,\n        entity_status,\n        frequency_cap,\n        funding_instrument_id,\n        id as campaign_id,\n        name as campaign_name,\n        servable as is_servable,\n        standard_delivery as is_standard_delivery,\n        start_time as start_timestamp,\n        total_budget_amount_local_micro,\n        updated_at as updated_timestamp,\n        round(daily_budget_amount_local_micro / 1000000.0,2) as daily_budget_amount,\n        round(total_budget_amount_local_micro / 1000000.0,2) as total_budget_amount,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_latest_version\n    \n    from fields \n)\n\nselect * from final", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.461955Z", "completed_at": "2023-12-12T20:10:11.757655Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.758390Z", "completed_at": "2023-12-12T20:10:11.758398Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3581070899963379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__account_history", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select *\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__account_history_tmp\"\n\n),\n\nfields as (\n\n    select\n    \n        \n    \n    \n    approval_status\n    \n as \n    \n    approval_status\n    \n, \n    \n    \n    business_id\n    \n as \n    \n    business_id\n    \n, \n    \n    \n    business_name\n    \n as \n    \n    business_name\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    deleted\n    \n as \n    \n    deleted\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    industry_type\n    \n as \n    \n    industry_type\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    salt\n    \n as \n    \n    salt\n    \n, \n    \n    \n    timezone\n    \n as \n    \n    timezone\n    \n, \n    \n    \n    timezone_switch_at\n    \n as \n    \n    timezone_switch_at\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from source\n\n), \n\nfinal as (\n\n    select\n        source_relation,\n        approval_status,\n        business_id,\n        business_name,\n        created_at as created_timestamp,\n        deleted as is_deleted,\n        id as account_id,\n        industry_type,\n        name,\n        salt,\n        timezone,\n        timezone_switch_at as timezone_switched_timestamp,\n        updated_at as updated_timestamp,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_latest_version\n    \n    from fields \n)\n\nselect * from final", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__account_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.473897Z", "completed_at": "2023-12-12T20:10:11.811799Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.821826Z", "completed_at": "2023-12-12T20:10:11.821830Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.38018298149108887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__line_item_history", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select *\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_history_tmp\"\n\n),\n\nfields as (\n\n    select\n    \n        \n    \n    \n    advertiser_domain\n    \n as \n    \n    advertiser_domain\n    \n, \n    \n    \n    advertiser_user_id\n    \n as \n    \n    advertiser_user_id\n    \n, \n    \n    \n    automatically_select_bid\n    \n as \n    \n    automatically_select_bid\n    \n, \n    \n    \n    bid_amount_local_micro\n    \n as \n    \n    bid_amount_local_micro\n    \n, \n    \n    \n    bid_type\n    \n as \n    \n    bid_type\n    \n, \n    \n    \n    bid_unit\n    \n as \n    \n    bid_unit\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    charge_by\n    \n as \n    \n    charge_by\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    creative_source\n    \n as \n    \n    creative_source\n    \n, \n    \n    \n    currency\n    \n as \n    \n    currency\n    \n, \n    \n    \n    deleted\n    \n as \n    \n    deleted\n    \n, \n    \n    \n    end_time\n    \n as \n    \n    end_time\n    \n, \n    \n    \n    entity_status\n    \n as \n    \n    entity_status\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    objective\n    \n as \n    \n    objective\n    \n, \n    \n    \n    optimization\n    \n as \n    \n    optimization\n    \n, \n    \n    \n    primary_web_event_tag\n    \n as \n    \n    primary_web_event_tag\n    \n, \n    \n    \n    product_type\n    \n as \n    \n    product_type\n    \n, \n    \n    \n    start_time\n    \n as \n    \n    start_time\n    \n, \n    \n    \n    target_cpa_local_micro\n    \n as \n    \n    target_cpa_local_micro\n    \n, \n    \n    \n    total_budget_amount_local_micro\n    \n as \n    \n    total_budget_amount_local_micro\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from source\n\n), \n\nfinal as (\n\n    select\n        source_relation,\n        advertiser_domain,\n        advertiser_user_id,\n        automatically_select_bid,\n        bid_amount_local_micro,\n        bid_type,\n        bid_unit,\n        campaign_id,\n        charge_by,\n        created_at as created_timestamp,\n        creative_source,\n        currency,\n        deleted as is_deleted,\n        end_time as end_timestamp,\n        entity_status,\n        id as line_item_id,\n        name,\n        objective,\n        optimization,\n        primary_web_event_tag,\n        product_type,\n        start_time as start_timestamp,\n        target_cpa_local_micro,\n        total_budget_amount_local_micro,\n        updated_at as updated_timestamp,\n        round(bid_amount_local_micro / 1000000.0,2) as bid_amount,\n        round(total_budget_amount_local_micro / 1000000.0,2) as total_budget_amount,\n        round(target_cpa_local_micro / 1000000.0,2) as target_cpa,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_latest_version\n    \n    from fields \n)\n\nselect * from final", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.467389Z", "completed_at": "2023-12-12T20:10:11.810524Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:11.813126Z", "completed_at": "2023-12-12T20:10:11.813132Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.40021204948425293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__campaign_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    billed_charge_local_micro\n    \n as \n    \n    billed_charge_local_micro\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    placement\n    \n as \n    \n    placement\n    \n, \n    \n    \n    url_clicks\n    \n as \n    \n    url_clicks\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date_trunc('day', date) as date_day,\n        account_id,\n        campaign_id,\n        placement,\n        clicks,\n        impressions,\n        billed_charge_local_micro as spend_micro,\n        round(billed_charge_local_micro / 1000000.0,2) as spend,\n        url_clicks\n\n        \n\n\n\n\n    \n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.818040Z", "completed_at": "2023-12-12T20:10:12.145182Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.146293Z", "completed_at": "2023-12-12T20:10:12.146300Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4084601402282715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__promoted_tweet_history", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select *\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_history_tmp\"\n\n),\n\nfields as (\n\n    select\n    \n        \n    \n    \n    approval_status\n    \n as \n    \n    approval_status\n    \n, \n    \n    \n    created_at\n    \n as \n    \n    created_at\n    \n, \n    \n    \n    deleted\n    \n as \n    \n    deleted\n    \n, \n    \n    \n    entity_status\n    \n as \n    \n    entity_status\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    line_item_id\n    \n as \n    \n    line_item_id\n    \n, \n    \n    \n    tweet_id\n    \n as \n    \n    tweet_id\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from source\n\n), \n\nfinal as (\n\n    select\n        source_relation,\n        approval_status,\n        created_at as created_timestamp,\n        deleted as is_deleted,\n        entity_status,\n        id as promoted_tweet_id,\n        line_item_id,\n        tweet_id,\n        updated_at as updated_timestamp,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_latest_version\n    from fields \n)\n\nselect * from final", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.813411Z", "completed_at": "2023-12-12T20:10:12.231273Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.232371Z", "completed_at": "2023-12-12T20:10:12.232378Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.4542720317840576, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__line_item_keywords_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_keywords_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    billed_charge_local_micro\n    \n as \n    \n    billed_charge_local_micro\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    line_item_id\n    \n as \n    \n    line_item_id\n    \n, \n    \n    \n    placement\n    \n as \n    \n    placement\n    \n, \n    \n    \n    segment\n    \n as \n    \n    segment\n    \n, \n    \n    \n    url_clicks\n    \n as \n    \n    url_clicks\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date_trunc('day', date) as date_day,\n        md5(cast(coalesce(cast(account_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(line_item_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(placement as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as keyword_id,\n        account_id,\n        line_item_id,\n        segment as keyword,\n        placement,\n        clicks,\n        impressions,\n        billed_charge_local_micro as spend_micro,\n        round(billed_charge_local_micro / 1000000.0,2) as spend,\n        url_clicks\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_keywords_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.855248Z", "completed_at": "2023-12-12T20:10:12.232663Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.233473Z", "completed_at": "2023-12-12T20:10:12.233477Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4124331474304199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__promoted_tweet_report", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select *\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_report_tmp\"\n\n),\n\nrenamed as (\n\n    select\n    \n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    billed_charge_local_micro\n    \n as \n    \n    billed_charge_local_micro\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    placement\n    \n as \n    \n    placement\n    \n, \n    \n    \n    promoted_tweet_id\n    \n as \n    \n    promoted_tweet_id\n    \n, \n    \n    \n    url_clicks\n    \n as \n    \n    url_clicks\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from source\n\n), spend_calc as (\n\n    select\n        source_relation,\n        date_trunc('day', date) as date_day,\n        account_id,\n        promoted_tweet_id,\n        placement,\n        clicks as clicks,\n        impressions as impressions,\n        billed_charge_local_micro as spend_micro,\n        round(billed_charge_local_micro / 1000000.0,2) as spend,\n        url_clicks as url_clicks\n\n        \n\n\n\n\n    \n    from renamed\n\n)\n\nselect * from spend_calc", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.274468Z", "completed_at": "2023-12-12T20:10:12.286992Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.288744Z", "completed_at": "2023-12-12T20:10:12.288751Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02557682991027832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.dbt_utils_unique_combination_of_columns_stg_twitter_ads__campaign_history_source_relation__campaign_id__updated_timestamp.9b0c16487d", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, updated_timestamp\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_history\"\n    group by source_relation, campaign_id, updated_timestamp\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:11.861262Z", "completed_at": "2023-12-12T20:10:12.262934Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.263655Z", "completed_at": "2023-12-12T20:10:12.263662Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4436368942260742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__line_item_report", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_report_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    billed_charge_local_micro\n    \n as \n    \n    billed_charge_local_micro\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    line_item_id\n    \n as \n    \n    line_item_id\n    \n, \n    \n    \n    placement\n    \n as \n    \n    placement\n    \n, \n    \n    \n    url_clicks\n    \n as \n    \n    url_clicks\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        date_trunc('day', date) as date_day,\n        account_id,\n        line_item_id,\n        placement,\n        clicks,\n        impressions,\n        billed_charge_local_micro as spend_micro,\n        round(billed_charge_local_micro / 1000000.0,2) as spend,\n        url_clicks\n\n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.298250Z", "completed_at": "2023-12-12T20:10:12.305777Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.310170Z", "completed_at": "2023-12-12T20:10:12.310178Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.016082048416137695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__campaign_history_campaign_id.51218487ce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_history\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.306220Z", "completed_at": "2023-12-12T20:10:12.311580Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.313085Z", "completed_at": "2023-12-12T20:10:12.313091Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012325763702392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.dbt_utils_unique_combination_of_columns_stg_twitter_ads__account_history_source_relation__account_id__updated_timestamp.3492933c38", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, updated_timestamp\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__account_history\"\n    group by source_relation, account_id, updated_timestamp\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.313436Z", "completed_at": "2023-12-12T20:10:12.322136Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.322994Z", "completed_at": "2023-12-12T20:10:12.323002Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011588811874389648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__account_history_account_id.66fb3601e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__account_history\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.318754Z", "completed_at": "2023-12-12T20:10:12.323946Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.325431Z", "completed_at": "2023-12-12T20:10:12.325435Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008281946182250977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.dbt_utils_unique_combination_of_columns_stg_twitter_ads__line_item_history_source_relation__line_item_id__updated_timestamp.646fa5270f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, line_item_id, updated_timestamp\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_history\"\n    group by source_relation, line_item_id, updated_timestamp\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.326752Z", "completed_at": "2023-12-12T20:10:12.334596Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.335228Z", "completed_at": "2023-12-12T20:10:12.335234Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010751962661743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__line_item_history_line_item_id.2cef040809", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect line_item_id\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_history\"\nwhere line_item_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.331144Z", "completed_at": "2023-12-12T20:10:12.336136Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.337937Z", "completed_at": "2023-12-12T20:10:12.337945Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008435964584350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.dbt_utils_unique_combination_of_columns_stg_twitter_ads__campaign_report_source_relation__date_day__campaign_id__placement.9d5717ee54", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, campaign_id, placement\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_report\"\n    group by source_relation, date_day, campaign_id, placement\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.339223Z", "completed_at": "2023-12-12T20:10:12.346731Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.347473Z", "completed_at": "2023-12-12T20:10:12.347484Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010985851287841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__campaign_report_campaign_id.a63b62981f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_report\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.343692Z", "completed_at": "2023-12-12T20:10:12.347827Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.349488Z", "completed_at": "2023-12-12T20:10:12.349492Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007486104965209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__campaign_report_date_day.053c09786c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_report\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.351263Z", "completed_at": "2023-12-12T20:10:12.359693Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.360267Z", "completed_at": "2023-12-12T20:10:12.360273Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010933876037597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__campaign_report_placement.5067d8c4f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect placement\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__campaign_report\"\nwhere placement is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.356249Z", "completed_at": "2023-12-12T20:10:12.365342Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.366064Z", "completed_at": "2023-12-12T20:10:12.366069Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011334896087646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.dbt_utils_unique_combination_of_columns_stg_twitter_ads__promoted_tweet_history_source_relation__promoted_tweet_id__updated_timestamp.7016099e0a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, promoted_tweet_id, updated_timestamp\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_history\"\n    group by source_relation, promoted_tweet_id, updated_timestamp\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.362045Z", "completed_at": "2023-12-12T20:10:12.366899Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.368145Z", "completed_at": "2023-12-12T20:10:12.368148Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007448911666870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__promoted_tweet_history_promoted_tweet_id.f447a1cd09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect promoted_tweet_id\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_history\"\nwhere promoted_tweet_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.369148Z", "completed_at": "2023-12-12T20:10:12.376957Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.377590Z", "completed_at": "2023-12-12T20:10:12.377596Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01071310043334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.dbt_utils_unique_combination_of_columns_stg_twitter_ads__line_item_keywords_report_source_relation__date_day__keyword_id.579bdc1f1c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, keyword_id\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_keywords_report\"\n    group by source_relation, date_day, keyword_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.373915Z", "completed_at": "2023-12-12T20:10:12.377890Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.379443Z", "completed_at": "2023-12-12T20:10:12.379447Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007142066955566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__line_item_keywords_report_date_day.c7e7155b13", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_keywords_report\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.381180Z", "completed_at": "2023-12-12T20:10:12.388791Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.389461Z", "completed_at": "2023-12-12T20:10:12.389468Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010536909103393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__line_item_keywords_report_keyword_id.e5f015e9ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_keywords_report\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.385639Z", "completed_at": "2023-12-12T20:10:12.389790Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.391407Z", "completed_at": "2023-12-12T20:10:12.391413Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00756382942199707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.dbt_utils_unique_combination_of_columns_stg_twitter_ads__promoted_tweet_report_source_relation__date_day__promoted_tweet_id__placement.9d96bf07d3", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, promoted_tweet_id, placement\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_report\"\n    group by source_relation, date_day, promoted_tweet_id, placement\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.393572Z", "completed_at": "2023-12-12T20:10:12.400811Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.401570Z", "completed_at": "2023-12-12T20:10:12.401577Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010368108749389648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__promoted_tweet_report_date_day.c4c46a5894", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_report\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.397876Z", "completed_at": "2023-12-12T20:10:12.402548Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.403992Z", "completed_at": "2023-12-12T20:10:12.403996Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007654905319213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__promoted_tweet_report_placement.c1b1f648b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect placement\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_report\"\nwhere placement is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.405098Z", "completed_at": "2023-12-12T20:10:12.410044Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.415395Z", "completed_at": "2023-12-12T20:10:12.415403Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.012362003326416016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__promoted_tweet_report_promoted_tweet_id.6028694598", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect promoted_tweet_id\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__promoted_tweet_report\"\nwhere promoted_tweet_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.410414Z", "completed_at": "2023-12-12T20:10:12.417204Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.421136Z", "completed_at": "2023-12-12T20:10:12.421148Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013043880462646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.dbt_utils_unique_combination_of_columns_stg_twitter_ads__line_item_report_source_relation__date_day__line_item_id__placement.6c8686e61c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, date_day, line_item_id, placement\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_report\"\n    group by source_relation, date_day, line_item_id, placement\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.418032Z", "completed_at": "2023-12-12T20:10:12.423191Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.426980Z", "completed_at": "2023-12-12T20:10:12.426986Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010824918746948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__line_item_report_date_day.0f4d8cc8fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_report\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.424023Z", "completed_at": "2023-12-12T20:10:12.428454Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.429940Z", "completed_at": "2023-12-12T20:10:12.429946Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010733604431152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__line_item_report_line_item_id.9f5a4860b7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect line_item_id\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_report\"\nwhere line_item_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.430281Z", "completed_at": "2023-12-12T20:10:12.434284Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.434925Z", "completed_at": "2023-12-12T20:10:12.434930Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0066030025482177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__line_item_report_placement.cd7e77e0eb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect placement\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__line_item_report\"\nwhere placement is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.221158Z", "completed_at": "2023-12-12T20:10:12.484964Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.485667Z", "completed_at": "2023-12-12T20:10:12.485673Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2934720516204834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__tweet", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__tweet_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    account_id\n    \n as \n    \n    account_id\n    \n, \n    \n    \n    full_text\n    \n as \n    \n    full_text\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    lang\n    \n as \n    \n    lang\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        account_id,\n        id as tweet_id,\n        name,\n        full_text,\n        lang as language\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__tweet\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.515488Z", "completed_at": "2023-12-12T20:10:12.523939Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.524633Z", "completed_at": "2023-12-12T20:10:12.524639Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010557889938354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.dbt_utils_unique_combination_of_columns_stg_twitter_ads__tweet_source_relation__tweet_id.70de7f05f5", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, tweet_id\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__tweet\"\n    group by source_relation, tweet_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.520002Z", "completed_at": "2023-12-12T20:10:12.524958Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.526155Z", "completed_at": "2023-12-12T20:10:12.526160Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007288932800292969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__tweet_tweet_id.a0427f37cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tweet_id\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__tweet\"\nwhere tweet_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.267989Z", "completed_at": "2023-12-12T20:10:12.575352Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.575908Z", "completed_at": "2023-12-12T20:10:12.575916Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.33730602264404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.twitter_ads_source.stg_twitter_ads__tweet_url", "compiled": true, "compiled_code": "\n\nwith source as (\n\n    select *\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__tweet_url_tmp\"\n\n),\n\nfields as (\n\n    select\n    \n        \n    \n    \n    display_url\n    \n as \n    \n    display_url\n    \n, \n    \n    \n    expanded_url\n    \n as \n    \n    expanded_url\n    \n, \n    \n    \n    index\n    \n as \n    \n    index\n    \n, \n    \n    \n    indices\n    \n as \n    \n    indices\n    \n, \n    \n    \n    tweet_id\n    \n as \n    \n    tweet_id\n    \n, \n    \n    \n    url\n    \n as \n    \n    url\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from source\n\n), \n\nfinal as (\n\n    select\n        source_relation,\n        display_url,\n        expanded_url,\n        index,\n        indices,\n        tweet_id,\n        url,\n        \n\n  \n    \n\n    split_part(\n        expanded_url,\n        '?',\n        1\n        )\n\n\n  \n\n as base_url,\n        \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        expanded_url,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/',\n        1\n        )\n\n\n  \n\n,\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_host,\n        '/' || \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n    right(\n        \n\n    replace(\n        \n\n    replace(\n        expanded_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        expanded_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    position(\n        '/' in \n\n    replace(\n        \n\n    replace(\n        expanded_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ), 0),\n            \n\n    position(\n        '?' in \n\n    replace(\n        \n\n    replace(\n        expanded_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ) - 1\n            )\n    ),\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_path,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        expanded_url,\n        'utm_source=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        expanded_url,\n        'utm_medium=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        expanded_url,\n        'utm_campaign=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        expanded_url,\n        'utm_content=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_content,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        expanded_url,\n        'utm_term=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_term\n    \n    from fields\n\n)\n\nselect * from final", "relation_name": "\"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__tweet_url\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.605436Z", "completed_at": "2023-12-12T20:10:12.610741Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.617749Z", "completed_at": "2023-12-12T20:10:12.617755Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013440132141113281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.dbt_utils_unique_combination_of_columns_stg_twitter_ads__tweet_url_source_relation__index__tweet_id.ce1a2b4a87", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, index, tweet_id\n    from \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__tweet_url\"\n    group by source_relation, index, tweet_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.611013Z", "completed_at": "2023-12-12T20:10:12.618661Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.619883Z", "completed_at": "2023-12-12T20:10:12.619889Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011211156845092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__tweet_url_index.e998fb67be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect index\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__tweet_url\"\nwhere index is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:10:12.613933Z", "completed_at": "2023-12-12T20:10:12.618912Z"}, {"name": "execute", "started_at": "2023-12-12T20:10:12.620225Z", "completed_at": "2023-12-12T20:10:12.620229Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.011341094970703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.twitter_ads_source.not_null_stg_twitter_ads__tweet_url_tweet_id.f7e1670218", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tweet_id\nfrom \"postgres\".\"twitter_ads_source_integration_tests_twitter_ads_source\".\"stg_twitter_ads__tweet_url\"\nwhere tweet_id is null\n\n\n", "relation_name": null}], "elapsed_time": 2.2688639163970947, "args": {"select": [], "log_format": "default", "cache_selected_only": false, "log_level": "info", "which": "generate", "log_level_file": "debug", "print": true, "send_anonymous_usage_stats": true, "log_file_max_bytes": 10485760, "enable_legacy_logger": false, "macro_debugging": false, "populate_cache": true, "printer_width": 80, "partial_parse_file_diff": true, "write_json": true, "empty_catalog": false, "project_dir": "/Users/joseph.markiewicz/Documents/dbt_packages/ad_reporting/twitter/dbt_twitter_source/integration_tests", "static_parser": true, "strict_mode": false, "vars": {}, "introspect": true, "indirect_selection": "eager", "log_path": "/Users/joseph.markiewicz/Documents/dbt_packages/ad_reporting/twitter/dbt_twitter_source/integration_tests/logs", "show_resource_report": false, "quiet": false, "compile": true, "version_check": true, "use_colors_file": true, "defer": false, "exclude": [], "warn_error_options": {"include": [], "exclude": []}, "partial_parse": true, "target": "postgres", "log_format_file": "debug", "static": false, "favor_state": false, "invocation_command": "dbt docs generate -t postgres", "profiles_dir": "/Users/joseph.markiewicz/.dbt", "use_colors": true}}